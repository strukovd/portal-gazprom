import{g as h,e as x,k as V,m as b,R as C,c as i,a as o,b as r,O as N,w as f,j as n,Q as w,F as z,r as I,o as l,d as g,n as v,t as m,S as _}from"#entry";import{B as y,a as $}from"./CNGPrdfm.js";import{B as A}from"./kX6qYou3.js";import{u as E}from"./dZZoRB3u.js";const M={class:"issues-page"},q={class:"issues"},F={class:"title"},R={class:"flex-line"},U={class:"issue-date"},j={class:"date"},D={key:0},H=h({__name:"index",setup(G){const{$api:B}=x(),k=V(),u=E(),a=b("");async function p(){const t={};t.page=1,t.size=10;const e=k.token;if(!e){console.error("No token");return}a.value&&(t.search=a.value);const s=await B("v1/portal/notes",{query:t,method:"GET",headers:{Authorization:`Bearer ${e}`}});if(s.success){const d=s.data,c=["#0079C1","#14cf34","#e3ce31"];d.forEach(S=>{const T=c[Math.floor(Math.random()*c.length)];S.color=T}),u.issues=d}}return C(()=>{p()}),(t,e)=>(l(),i("section",M,[o("div",q,[e[7]||(e[7]=o("h1",{style:{margin:".4em 0"}},"Заявки сотрудника",-1)),r(y,{onClick:e[0]||(e[0]=s=>("navigateTo"in t?t.navigateTo:n(v))("/issues/create")),prependIcon:"mdi-file-document-plus-outline",style:{"font-size":"1.4em","flex-basis":"auto","flex-grow":"1","margin-bottom":".4em"}},{default:f(()=>[...e[3]||(e[3]=[g("Добавить заявку",-1)])]),_:1}),r(A,{modelValue:n(a),"onUpdate:modelValue":e[1]||(e[1]=s=>w(a)?a.value=s:null),onSubmit:p,style:{width:"100%"},"prepend-icon":"mdi-magnify",button:"Найти",placeholder:"Поиск"},null,8,["modelValue"]),(l(!0),i(z,null,I(n(u).issues,s=>(l(),i("div",{class:"issue",key:String(s.summary).slice(0,4)},[o("div",F,m(s.summary),1),o("div",R,[o("div",U,[e[4]||(e[4]=o("span",null,"Дата подачи: ",-1)),o("span",j,m(s.date),1)]),o("div",{class:"status",style:_({background:s.color})},m(s.issueStatus),5)]),r(y,{onClick:e[2]||(e[2]=d=>("navigateTo"in t?t.navigateTo:n(v))("/construct-pass")),prependIcon:"mdi-file-document-plus-outline"},{default:f(()=>[...e[5]||(e[5]=[g("Добавить строй паспорт",-1)])]),_:1})]))),128)),n(u).issues.length?N("",!0):(l(),i("div",D,[r($,{name:"mdi-magnify",size:"1.2em",style:{margin:"0 .4em 0 0"}}),e[6]||(e[6]=o("span",null,"Ничего не найдено",-1))]))])]))}});export{H as default};
