import{g as T,e as x,k as C,m as V,R as b,c as i,a as o,b as r,O as N,w as f,j as n,Q as _,F as w,r as z,o as l,d as g,n as v,t as m,S as $}from"#entry";import{B as y,a as I}from"./-_DaJmk0.js";import{B as A}from"./BsjxlfTr.js";import{u as E}from"./CBQEV4ZP.js";const M={class:"issues-page"},q={class:"issues"},F={class:"title"},K={class:"flex-line"},R={class:"issue-date"},U={class:"date"},j={key:0},Q=T({__name:"index",setup(D){const{$api:k}=x(),B=C(),u=E(),a=V("");async function c(){const t={};t.page=1,t.size=10;const e=B.token;if(!e){console.error("No token");return}a.value&&(t.search=a.value);const s=await k("v1/portal/notes",{query:t,method:"GET",headers:{Authorization:`Bearer ${e}`}});if(s.success){const d=s.data,p=["#0079C1","#14cf34","#e3ce31"];d.forEach(S=>{const h=p[Math.floor(Math.random()*p.length)];S.color=h}),u.issues=d}}return b(()=>{c()}),(t,e)=>(l(),i("section",M,[o("div",q,[e[6]||(e[6]=o("h1",{style:{margin:".4em 0"}},"Заявки сотрудника",-1)),r(y,{onClick:e[0]||(e[0]=s=>("navigateTo"in t?t.navigateTo:n(v))("/issues/create")),prependIcon:"mdi-file-document-plus-outline",style:{"font-size":"1.4em","flex-basis":"auto","flex-grow":"1","margin-bottom":".4em"}},{default:f(()=>[...e[2]||(e[2]=[g("Добавить заявку",-1)])]),_:1}),r(A,{modelValue:n(a),"onUpdate:modelValue":e[1]||(e[1]=s=>_(a)?a.value=s:null),onSubmit:c,style:{width:"100%"},"prepend-icon":"mdi-magnify",button:"Найти",placeholder:"Поиск"},null,8,["modelValue"]),(l(!0),i(w,null,z(n(u).issues,s=>(l(),i("div",{class:"issue",key:String(s.summary).slice(0,4)},[o("div",F,m(s.summary),1),o("div",K,[o("div",R,[e[3]||(e[3]=o("span",null,"Дата подачи: ",-1)),o("span",U,m(s.date),1)]),o("div",{class:"status",style:$({background:s.color})},m(s.issueStatus),5)]),r(y,{onClick:d=>("navigateTo"in t?t.navigateTo:n(v))(`/issues/construct-pass?issueKey=${s.issueKey}`),prependIcon:"mdi-file-document-plus-outline"},{default:f(()=>[...e[4]||(e[4]=[g("Добавить строй паспорт",-1)])]),_:1},8,["onClick"])]))),128)),n(u).issues.length?N("",!0):(l(),i("div",j,[r(I,{name:"mdi-magnify",size:"1.2em",style:{margin:"0 .4em 0 0"}}),e[5]||(e[5]=o("span",null,"Ничего не найдено",-1))]))])]))}});export{Q as default};
