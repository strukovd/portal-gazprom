import{g as C,_ as z,c as V,o as p,F as T,r as M,S as E,T as N,U as G,O as g,a as n,t as b,A as h,b as a,d as r,w as S,M as D,e as H,k as K,m as w,V as x,Q as R,j as t,W as F,X as $}from"#entry";import{a as y,B as O}from"./-_DaJmk0.js";import{B as d}from"./BsjxlfTr.js";import{B as v}from"./CUozBVGZ.js";import{u as W}from"./CBQEV4ZP.js";const q=C({name:"FilterTabs",components:{BaseIcon:y},props:{modelValue:{type:[Object,String,Number],default:void 0},items:Array,autoselect:{type:Boolean,default:!1}},emits:["update:modelValue"],data(){return{selectedKey:null}},watch:{items(){this.modelValue||this.autoselect&&!this.selectedKey&&this.items?.length&&(this.selectedKey=this.items[0].key)},selectedKey(){this.onSelected(this.selectedKey)}},beforeMount(){this.autoselect&&this.items?.length&&(this.selectedKey=this.items[0].key)},methods:{onSelected(s){this.selectedKey=s,this.$emit("update:modelValue",this.selectedKey)}}}),L={class:"tabs"},Q=["id","onClick"],X={style:{"font-weight":"300"}},J={key:1,class:"error-counter"};function Y(s,u,U,B,f,l){const k=h("BaseIcon");return p(),V("section",L,[(p(!0),V(T,null,M(s.items,i=>(p(),V("button",{type:"button",class:N(["tab-button",{selected:s.modelValue===i.key}]),key:i.key,id:`tab-${i.key}`,style:E({background:s.modelValue===i.key&&i.color?i.color:""}),onClick:c=>s.onSelected(i.key)},[i.icon?(p(),G(k,{key:0,name:i.icon,size:"1.2em",style:{"margin-right":".2em",opacity:".8","vertical-align":"baseline"}},null,8,["name"])):g("",!0),n("span",X,b(i.caption),1),i.badge?(p(),V("div",J,b(i.badge),1)):g("",!0)],14,Q))),128))])}const Z=Object.assign(z(q,[["render",Y]]),{__name:"CommonBaseTabs"}),_=C({name:"BaseFilePicker",components:{BaseButton:O,BaseIcon:y},emits:["update:modelValue"],props:{label:String,src:String,modelValue:Object,error:String},watch:{src(s,u){this.storedFile=s},modelValue(s,u){this.selectedFileObject=s}},data(){return{storedFile:null,selectedFileObject:null}},methods:{onClick(s){this.$refs.fileInput.click()},onSelectFile(s){const u=s?.dataTransfer?.files[0]||s.target.files[0];u&&(this.selectedFileObject=u,this.$emit("update:modelValue",this.selectedFileObject))},getSelectedFile(){return this.selectedFileObject}},created(){this.src&&(this.storedFile=this.src)}}),ee={class:"header",style:{display:"flex","align-items":"center","padding-right":"1em"}},le={key:0,class:"caption-container",style:{flex:"auto 1 1"}},oe={class:"caption"},te={key:1,class:"error-container",style:{display:"flex",gap:".2em","justify-content":"flex-end","font-size":"14px",color:"red",opacity:".6","line-height":"1.4em"}},ae={class:"error-message"},ne={class:"drop-zone"},se={key:0,class:"empty-section"},de={key:1,class:"preview-section"},ue={style:{display:"inline-block","font-size":"1.6em",padding:".4em 1em"}};function ie(s,u,U,B,f,l){const k=h("BaseIcon"),i=h("BaseButton");return p(),V("div",{class:N(["file-picker-box",{invalid:s.error}])},[n("header",ee,[s.label?(p(),V("div",le,[n("span",oe,b(s.label),1)])):g("",!0),s.error?(p(),V("div",te,[a(k,{name:"mdi-alert-decagram",size:"1.2em"}),n("span",ae,b(s.error),1)])):g("",!0)]),n("div",{class:N(["file-picker",{unstored:s.selectedFileObject}]),onDragover:u[1]||(u[1]=D(()=>{},["prevent"])),onDrop:u[2]||(u[2]=D((...c)=>s.onSelectFile&&s.onSelectFile(...c),["prevent"]))},[n("div",ne,[s.selectedFileObject?(p(),V("section",de,[n("div",ue,b(s.selectedFileObject?.name),1)])):(p(),V("section",se,[a(k,{class:"icon",name:"mdi-file-document-plus-outline"})])),u[4]||(u[4]=n("section",{class:"label-section"},[n("span",null,[r("Перетащите файл сюда или нажмите "),n("br"),r(" «Выбрать файл».")])],-1)),a(i,{class:"button",prependIcon:"mdi-plus",onClick:s.onClick,color:"primary"},{default:S(()=>[...u[3]||(u[3]=[n("span",null,"Выбрать файл",-1)])]),_:1},8,["onClick"])]),n("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:u[0]||(u[0]=(...c)=>s.onSelectFile&&s.onSelectFile(...c))},null,544)],34)],2)}const P=Object.assign(z(_,[["render",ie]]),{__name:"CommonBaseFilePicker"}),me={class:"create-issue-page"},re={class:"forms"},pe={key:1},Ve={key:2,class:"error",style:{"margin-top":"1em",color:"red"}},ge=C({__name:"create",setup(s){const{$api:u}=H(),U=K();W();const B=[{key:"NGV4",caption:"Новая газифиция",icon:"mdi-file-document-plus-outline"},{key:"PRV4",caption:"Перемонтаж",icon:"mdi-file-document-multiple-outline"}],f=w(""),l=x({}),k=w("");async function i(){const c={},e=U.token;if(!e){console.error("No token");return}const o=new FormData;o.append("key",f.value);const I=["scanOfHousePassport"],j=["plannedGasUsingDevices","gasConsumptionPattern"];Object.keys(l).forEach(m=>{I.includes(m)||j.includes(m)||o.append(m,l[m])}),j.forEach(m=>{String(l[m]).split(",").forEach(A=>{o.append(m,A)})}),I.forEach(m=>{o.append("files",l[m])}),u("v1/applications",{query:c,method:"POST",headers:{Authorization:`Bearer ${e}`},body:o}).then(m=>m.json()).then(m=>{console.log(m)}).catch(m=>{k.value=m.data.message,console.error(m)})}return(c,e)=>(p(),V("section",me,[n("section",re,[a(Z,{modelValue:t(f),"onUpdate:modelValue":e[0]||(e[0]=o=>R(f)?f.value=o:null),autoselect:"",items:B},null,8,["modelValue"]),t(f)==="NGV4"?(p(),V("form",{key:0,onSubmit:D(i,["prevent"])},[n("h2",null,[a(y,{name:"mdi-account-outline"}),e[33]||(e[33]=r(" Информация о владельце объекта",-1))]),a(d,{name:"surname",modelValue:t(l).surname,"onUpdate:modelValue":e[1]||(e[1]=o=>t(l).surname=o),placeholder:"Фамилия"},null,8,["modelValue"]),a(d,{name:"name",modelValue:t(l).name,"onUpdate:modelValue":e[2]||(e[2]=o=>t(l).name=o),placeholder:"Имя"},null,8,["modelValue"]),a(d,{name:"lname",modelValue:t(l).lname,"onUpdate:modelValue":e[3]||(e[3]=o=>t(l).lname=o),placeholder:"Отчество"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-office-building-marker-outline"}),e[34]||(e[34]=r(" Информация об объекте газификации",-1))]),a(d,{name:"address",placeholder:"Адрес"}),a(P,{modelValue:t(l).scanOfHousePassport,"onUpdate:modelValue":e[4]||(e[4]=o=>t(l).scanOfHousePassport=o),label:"Скан. тех. паспорта на дом"},null,8,["modelValue"]),a(v,{multiple:"",modelValue:t(l).plannedGasUsingDevices,"onUpdate:modelValue":e[5]||(e[5]=o=>t(l).plannedGasUsingDevices=o),items:[{key:"плита",value:"Плита"},{key:"колет",value:"Колет"},{key:"газовая колонка",value:"Газовая колонка"}],placeholder:"Планируемые газоиспользующие приборы"},null,8,["modelValue"]),a(v,{multiple:"",modelValue:t(l).gasConsumptionPattern,"onUpdate:modelValue":e[6]||(e[6]=o=>t(l).gasConsumptionPattern=o),items:[{key:"отопление",value:"Отопление"},{key:"горячее водоснабжение",value:"Горячее водоснабжение"},{key:"pis",value:"Пищеприготовление"}],placeholder:"Характер потребления газа"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-card-account-details-outline"}),e[35]||(e[35]=r(" Паспортные данные",-1))]),a(d,{name:"tin",modelValue:t(l).inn,"onUpdate:modelValue":e[7]||(e[7]=o=>t(l).inn=o),placeholder:"ИНН"},null,8,["modelValue"]),r(" "+b(t(l).inn)+" ",1),a(v,{modelValue:t(l).gender,"onUpdate:modelValue":e[8]||(e[8]=o=>t(l).gender=o),items:[{key:"M",value:"Мужской"},{key:"F",value:"Женский"}],placeholder:"Пол"},null,8,["modelValue"]),a(d,{name:"birthdate",modelValue:t(l).birthDate,"onUpdate:modelValue":e[9]||(e[9]=o=>t(l).birthDate=o),type:"date",placeholder:"Дата рождения"},null,8,["modelValue"]),a(d,{name:"passportNum",modelValue:t(l).passportNum,"onUpdate:modelValue":e[10]||(e[10]=o=>t(l).passportNum=o),placeholder:"Номер паспорта"},null,8,["modelValue"]),a(d,{name:"issueDate",modelValue:t(l).passportIssuedDate,"onUpdate:modelValue":e[11]||(e[11]=o=>t(l).passportIssuedDate=o),type:"date",placeholder:"Дата выдачи"},null,8,["modelValue"]),a(d,{name:"issuedBy",modelValue:t(l).passportIssuedBy,"onUpdate:modelValue":e[12]||(e[12]=o=>t(l).passportIssuedBy=o),placeholder:"Орган выдачи"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-phone-outline"}),e[36]||(e[36]=r(" Контактные данные",-1))]),a(d,{name:"email",modelValue:t(l).email,"onUpdate:modelValue":e[13]||(e[13]=o=>t(l).email=o),placeholder:"Электронный адрес"},null,8,["modelValue"]),a(d,{name:"phone",modelValue:t(l).contactNumber,"onUpdate:modelValue":e[14]||(e[14]=o=>t(l).contactNumber=o),placeholder:"Контактный номер"},null,8,["modelValue"]),a(d,{name:"whatsapp",modelValue:t(l).whatsappNumber,"onUpdate:modelValue":e[15]||(e[15]=o=>t(l).whatsappNumber=o),placeholder:"WhatsApp номер"},null,8,["modelValue"]),n("div",null,[n("label",null,[F(n("input",{"onUpdate:modelValue":e[16]||(e[16]=o=>t(l).agreement=o),type:"checkbox"},null,512),[[$,t(l).agreement]]),e[37]||(e[37]=r()),e[38]||(e[38]=n("span",null,"Согласие на обработку персональных данных",-1))])]),a(O,{onClick:i,prependIcon:"mdi-content-save"},{default:S(()=>[...e[39]||(e[39]=[r("Сохранить",-1)])]),_:1})],32)):t(f)==="PRV4"?(p(),V("form",pe,[n("h2",null,[a(y,{name:"mdi-account-outline"}),e[40]||(e[40]=r(" Информация о владельце объекта",-1))]),a(d,{name:"account",modelValue:t(l).account,"onUpdate:modelValue":e[17]||(e[17]=o=>t(l).account=o),placeholder:"Лицевой счет"},null,8,["modelValue"]),a(d,{name:"surname",modelValue:t(l).surname,"onUpdate:modelValue":e[18]||(e[18]=o=>t(l).surname=o),placeholder:"Фамилия"},null,8,["modelValue"]),a(d,{name:"name",modelValue:t(l).name,"onUpdate:modelValue":e[19]||(e[19]=o=>t(l).name=o),placeholder:"Имя"},null,8,["modelValue"]),a(d,{name:"lname",modelValue:t(l).lname,"onUpdate:modelValue":e[20]||(e[20]=o=>t(l).lname=o),placeholder:"Отчество"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-office-building-marker-outline"}),e[41]||(e[41]=r(" Информация об объекте газификации",-1))]),a(P,{modelValue:t(l).scanOfHousePassport,"onUpdate:modelValue":e[21]||(e[21]=o=>t(l).scanOfHousePassport=o),label:"Скан. тех. паспорта на дом"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-card-account-details-outline"}),e[42]||(e[42]=r(" Паспортные данные",-1))]),a(d,{name:"tin",modelValue:t(l).inn,"onUpdate:modelValue":e[22]||(e[22]=o=>t(l).inn=o),placeholder:"ИНН"},null,8,["modelValue"]),a(v,{modelValue:t(l).gender,"onUpdate:modelValue":e[23]||(e[23]=o=>t(l).gender=o),items:[{key:"M",value:"Мужской"},{key:"F",value:"Женский"}],placeholder:"Пол"},null,8,["modelValue"]),a(d,{name:"birthdate",modelValue:t(l).birthDate,"onUpdate:modelValue":e[24]||(e[24]=o=>t(l).birthDate=o),type:"date",placeholder:"Дата рождения"},null,8,["modelValue"]),a(d,{name:"passportNum",modelValue:t(l).passportNum,"onUpdate:modelValue":e[25]||(e[25]=o=>t(l).passportNum=o),placeholder:"Номер паспорта"},null,8,["modelValue"]),a(d,{name:"issueDate",modelValue:t(l).passportIssuedDate,"onUpdate:modelValue":e[26]||(e[26]=o=>t(l).passportIssuedDate=o),type:"date",placeholder:"Дата выдачи"},null,8,["modelValue"]),a(d,{name:"issuedBy",modelValue:t(l).passportIssuedBy,"onUpdate:modelValue":e[27]||(e[27]=o=>t(l).passportIssuedBy=o),placeholder:"Орган выдачи"},null,8,["modelValue"]),n("h2",null,[a(y,{name:"mdi-phone-outline"}),e[43]||(e[43]=r(" Контактные данные",-1))]),a(d,{name:"email",modelValue:t(l).email,"onUpdate:modelValue":e[28]||(e[28]=o=>t(l).email=o),placeholder:"Электронный адрес"},null,8,["modelValue"]),a(d,{name:"phone",modelValue:t(l).contactNumber,"onUpdate:modelValue":e[29]||(e[29]=o=>t(l).contactNumber=o),placeholder:"Контактный номер"},null,8,["modelValue"]),a(d,{name:"whatsapp",modelValue:t(l).whatsappNumber,"onUpdate:modelValue":e[30]||(e[30]=o=>t(l).whatsappNumber=o),placeholder:"WhatsApp номер"},null,8,["modelValue"]),n("div",null,[n("label",null,[F(n("input",{"onUpdate:modelValue":e[31]||(e[31]=o=>t(l).agreement=o),type:"checkbox"},null,512),[[$,t(l).agreement]]),e[44]||(e[44]=r()),e[45]||(e[45]=n("span",null,"Согласие на обработку персональных данных",-1))])]),n("div",null,[n("label",null,[F(n("input",{"onUpdate:modelValue":e[32]||(e[32]=o=>t(l).updateData=o),type:"checkbox"},null,512),[[$,t(l).updateData]]),e[46]||(e[46]=r()),e[47]||(e[47]=n("span",null,"Обновить данные абонента",-1))])]),a(O,{prependIcon:"mdi-content-save"},{default:S(()=>[...e[48]||(e[48]=[r("Сохранить",-1)])]),_:1})])):g("",!0),t(k)?(p(),V("div",Ve,b(t(k)),1)):g("",!0)])]))}});export{ge as default};
