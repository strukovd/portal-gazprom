import{P as B,d as h,a as S,O as k,r as _,Q as x,x as n,z as t,B as d,L as N,N as T,I as r,R as V,S as C,y as i,A as c,T as z,C as I,D as A,q as b}from"#entry";import{B as q,a as w}from"./B_Cfa3ff.js";import{B as E}from"./uIRjbwuk.js";const M=B("app",{state:()=>({issues:[]}),actions:{}}),$={class:"issues-page"},D={class:"issues"},L={class:"title"},P={class:"flex-line"},R={class:"issue-date"},U={class:"date"},F={key:0},H=h({__name:"index",setup(G){const{$api:f}=S(),g=k(),l=M(),a=_("");async function m(){console.log("fetchIssues");const o={};o.page=1,o.size=10;const s=g.token;if(!s){console.error("No token");return}a.value&&(o.search=a.value);const e=await f("contractors/notes",{query:o,method:"GET",headers:{Authorization:`Bearer ${s}`}});if(e.success){const u=e.data,p=["#0079C1","#14cf34","#e3ce31"];u.forEach(y=>{const v=p[Math.floor(Math.random()*p.length)];y.color=v}),l.issues=u}}return x(()=>{m()}),(o,s)=>(i(),n("section",$,[t("div",D,[s[5]||(s[5]=t("h1",null,"Заявки сотрудника",-1)),d(E,{modelValue:r(a),"onUpdate:modelValue":s[0]||(s[0]=e=>T(a)?a.value=e:null),onSubmit:m,style:{width:"100%"},"prepend-icon":"mdi-magnify",button:"Найти",placeholder:"Поиск"},null,8,["modelValue"]),(i(!0),n(V,null,C(r(l).issues,e=>(i(),n("div",{class:"issue",key:String(e.summary).slice(0,4)},[t("div",L,c(e.summary),1),t("div",P,[t("div",R,[s[2]||(s[2]=t("span",null,"Дата подачи: ",-1)),t("span",U,c(e.date),1)]),t("div",{class:"status",style:z({background:e.color})},c(e.issueStatus),5)]),d(q,{onClick:s[1]||(s[1]=u=>("navigateTo"in o?o.navigateTo:r(b))("/construct-pass")),prependIcon:"mdi-plus"},{default:I(()=>[...s[3]||(s[3]=[A("Добавить строй паспорт",-1)])]),_:1})]))),128)),r(l).issues.length?N("",!0):(i(),n("div",F,[d(w,{name:"mdi-magnify",size:"1.2em",style:{margin:"0 .4em 0 0"}}),s[4]||(s[4]=t("span",null,"Ничего не найдено",-1))]))])]))}});export{H as default};
