import{O as B,d as h,a as S,r as k,P as _,x as n,z as t,B as d,L as x,N,I as r,Q as V,R as C,y as i,A as p,S as T,C as z,D as I,q as A}from"#entry";import{B as b,a as q}from"./CY809v6N.js";import{B as w}from"./C_IVnQ6K.js";import{u as E}from"./B9A-FjJh.js";import"./DlAUqK2U.js";const M=B("app",{state:()=>({issues:[]}),actions:{}}),$={class:"issues-page"},D={class:"issues"},L={class:"title"},P={class:"flex-line"},R={class:"issue-date"},U={class:"date"},F={key:0},K=h({__name:"index",setup(G){const{$api:f}=S(),g=E(),l=M(),a=k("");async function c(){console.log("fetchIssues");const o={};o.page=1,o.size=10;const s=g.token;if(!s){console.error("No token");return}a.value&&(o.search=a.value);const e=await f("contractors/notes",{query:o,method:"GET",headers:{Authorization:`Bearer ${s}`}});if(e.success){const u=e.data,m=["#0079C1","#14cf34","#e3ce31"];u.forEach(y=>{const v=m[Math.floor(Math.random()*m.length)];y.color=v}),l.issues=u}}return _(()=>{c()}),(o,s)=>(i(),n("section",$,[t("div",D,[s[5]||(s[5]=t("h1",null,"Заявки сотрудника",-1)),d(w,{modelValue:r(a),"onUpdate:modelValue":s[0]||(s[0]=e=>N(a)?a.value=e:null),onSubmit:c,style:{width:"100%"},"prepend-icon":"mdi-magnify",button:"Найти",placeholder:"Поиск"},null,8,["modelValue"]),(i(!0),n(V,null,C(r(l).issues,e=>(i(),n("div",{class:"issue",key:String(e.summary).slice(0,4)},[t("div",L,p(e.summary),1),t("div",P,[t("div",R,[s[2]||(s[2]=t("span",null,"Дата подачи: ",-1)),t("span",U,p(e.date),1)]),t("div",{class:"status",style:T({background:e.color})},"Согласование ЭЧ",4)]),d(b,{onClick:s[1]||(s[1]=u=>("navigateTo"in o?o.navigateTo:r(A))("/construct-pass")),prependIcon:"mdi-plus"},{default:z(()=>[...s[3]||(s[3]=[I("Добавить строй паспорт",-1)])]),_:1})]))),128)),r(l).issues.length?x("",!0):(i(),n("div",F,[d(q,{name:"mdi-magnify",size:"1.2em",style:{margin:"0 .4em 0 0"}}),s[4]||(s[4]=t("span",null,"Ничего не найдено",-1))]))])]))}});export{K as default};
